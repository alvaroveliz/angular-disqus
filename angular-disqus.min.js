/* 
 * angular-disqus 1.1.0-a
 * http://github.com/alvaroveliz/angular-disqus
 * 
 * Licensed under the MIT license
 */
!function(i,e){"use strict";var n=i.module("ngDisqus",[]);n.provider("$disqus",function(){function n(){return document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]}function t(){return f||e.disqus_shortname}function r(i,e){return"//"+i+".disqus.com/"+e}function s(i){var e=document.createElement("script");return e.type="text/javascript",e.async=!0,e.src=i,e}function u(i,e){var n,t,r=i.getElementsByTagName("script");for(t=0;t<r.length;t+=1)if(n=r[t],~n.src.indexOf(e))return!0;return!1}function d(i,n,t){e.disqus_identifier=i,e.disqus_url=n,e.disqus_shortname=t}function o(){e.DISQUSWIDGETS=void 0,a(f,l,!0)}function c(i,n){e.DISQUS.reset({reload:!0,config:function(){this.page.identifier=n,this.page.url=i.absUrl()}})}function a(i,e,t){var d=n(),o=r(i,e);t="undefined"!=typeof t?t:!1,u(d,o)&&0==t||d.appendChild(s(o))}var f,m="embed.js",l="count.js";this.setShortname=function(i){f=i},this.$get=["$location",function(n){function r(r){var s=t();if(!i.isDefined(s))throw new Error("No disqus shortname defined");if(!i.isDefined(r))throw new Error("No disqus thread id defined");i.isDefined(e.DISQUS)?c(n,r):(d(r,n.absUrl(),s),a(s,m))}function s(i){d(i,n.absUrl(),f),a(t(),l),o()}return{commit:r,getShortname:t,loadCount:s}}]}),n.directive("disqus",["$disqus",function(e){return{restrict:"AC",replace:!0,scope:{id:"=disqus"},template:'<div id="disqus_thread"></div>',link:function(n){n.$watch("id",function(n){i.isDefined(n)&&e.commit(n)})}}}]),n.directive("disqusIdentifier",["$disqus",function(i){return{restrict:"A",link:function(e,n,t){i.loadCount(t.disqusIdentifier)}}}])}(angular,this);